name: "Duo Security Auth Logs to Tarsal"
description: "Transforms Duo Security Auth Logs into Tarsal Schema"
author: "Monad"
contributors:
  - "https://github.com/saikapuluru99"
inputs:
  - "duo-security-auth-logs"
tags:
  - "v1.0.0"
  - "duo-security"
  - "tarsal"
config:
  operations:
    - operation: "jq"
      arguments:
        key: ""
        query: |
          {
            "data": . + {
                "t_parse_time": now | strftime("%Y-%m-%dT%H:%M:%S.%fZ"),
                "t_event_time": .isotimestamp,
                "t_ip_address": .access_device?.ip // .auth_device?.ip // null,
                "t_email_address": .email
            }
          }