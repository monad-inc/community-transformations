name: "Github Audit Logs to Tarsal"
description: "Transforms Github Audit Logs into Tarsal Schema"
author: "Monad"
contributors:
  - "https://github.com/saikapuluru99"
inputs:
  - "github-audit-logs"
tags:
  - "v1.0.0"
  - "github"
  - "tarsal"
config:
  operations:
    - operation: "jq"
      arguments:
        key: ""
        query: |
          {
            "data": . + {
                "t_parse_time": now | strftime("%Y-%m-%dT%H:%M:%S.%fZ"),
                "t_event_time": (.created_t? // empty | . / 1000 | strftime("%Y-%m-%dT%H:%M:%S.%fZ")) // null,
                "t_ip_address": .actor_ip,
                "t_email_address": .data?.email
            }
          }